// This file is part of Christmas Event 
// author: Jenalya, Chayenne, cinderweb, wushin
// please see #XmasConfig

function|script|XmasNaughty|,
{
    set @xmas_karma, ((XMASTIME & NIBBLE_1_MASK) >> NIBBLE_1_SHIFT);
    if((@xmas_karma - @karma_bonus) >= 0)
        set @xmas_karma, (@xmas_karma - @karma_bonus);
    set XMASTIME, (XMASTIME & ~(NIBBLE_1_MASK) | (@xmas_karma << NIBBLE_1_SHIFT));
    set @karma_bonus, 0;
    return;
}

function|script|XmasNice|,
{
    set @xmas_karma, ((XMASTIME & NIBBLE_1_MASK) >> NIBBLE_1_SHIFT);
    if((@xmas_karma + @karma_bonus) < 16)
        set @xmas_karma, (@karma_bonus + @xmas_karma);
    set XMASTIME, (XMASTIME & ~(NIBBLE_1_MASK) | (@xmas_karma << NIBBLE_1_SHIFT));
    set @karma_bonus, 0;
    return;
}

function|script|XmasSetState|,
{
//    set $@xmas_bonus_xp, 4;
//    if (BASE_LEVEL >= 10)
//        getexp ((BASE_LEVEL / 10) * ($@xmas_bonus_xp * BASE_LEVEL)), 0;
//    getexp ($@xmas_bonus_xp * BASE_LEVEL), 0;
    set XMASTIME, (XMASTIME & ~(NIBBLE_0_MASK) | (@xmas_state << NIBBLE_0_SHIFT));
    return;
}

function|script|XmasSetSide|,
{
    set XMASTIME, XMASTIME | $@xmas_side_bit;
    return;
}

function|script|XmasThrowOut|,
{
    set XMASTIME, XMASTIME | $@xmas_thrown_out_bit;
}

function|script|XmasSetBossStart|,
{
    set XMASTIME, XMASTIME | $@xmas_boss_start_bit;
    return;
}

function|script|XmasSetBossHero|,
{
    set XMASTIME, XMASTIME | $@xmas_boss_hero_bit;
    return;
}

function|script|XmasReward|,
{
    if($@xmas_time == $@xmas_reward_time)
        goto L_FinalGift;
    goto L_NotTime;

L_FinalGift:
    // Random Reward Generator Based off 2 arrays Naughty and Nice;
    // Check side
    // get karma
    // 50 +/- karma depending on side
    // Plus Perfects/Hard mode
    // Give X presents by trees.
    end;

L_NotTime:
    end;
}

function|script|XmasCheckOld|,
{
    if(XMASYEAR == $XMAS_TIME_KEY)
        goto L_Return;

L_OldMatch:
    set XMASTIME, 0;
    set XMASYEAR, $XMAS_TIME_KEY;
    goto L_Return;

L_Return:
    return;
}
